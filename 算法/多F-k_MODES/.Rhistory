NN<-ni[j,]
MM<-data[i,]
ww<-Distance_of_Categorical(MM,NN)
q<-matrix(c(rep(data[i, ],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
w<-matrix(c(ww),nrow=K,ncol=1)
Dist[j]<-1/(sum((w/dist)^10))
}
FW_dist<-as.matrix(Dist)
ind<-which(FW_dist==max(FW_dist[,1]),arr.ind = T)[1]
cid[i]<-ind
}
cid
View(data)
data
K
iiter
InitialCenters<-c(1,2,3)
{
n<-nrow(data)
d<-ncol(data)
}
n
d
cid<-vector(length=n)
oldcia<-matrix(1,nrow=n,ncol=K)
nr<-matrix(0,nrow=n,ncol=K)
if(is.null(InitialCenters)){
centers<-data[sample(n,K),]
}else{
centers<-data[InitialCenters,]
}
row.names(centers)<-c(1:K)
centers
InitialCenters<-c(1,2,3,4,5,6,7)
if(is.null(InitialCenters)){
centers<-data[sample(n,K),]
}else{
centers<-data[InitialCenters,]
}
row.names(centers)<-c(1:K)
ni<-centers
ni
View(data)
ptm<-proc.time()
FW_dist<-vector()
Dist<-vector()
for(i in 1:n)
{
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
for(j in 1:K)
{
MM<-data[i,]
NN<-ni[j,]
WW<-Distance_of_Categorical(MM,NN)
if(WW==0){
Dist[j]<-1
}else{
W<-matrix(c(WW),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Fw_dist<-as.matrix(Dist)
ind<-which(Fw_dist==max(Fw_dist[,1]),arr.ind = T)[1]
cid[i]<-ind
}
cid
nr<-table(cid)
nr
for(i in 1:K)
{
data1<-data[(cid==i),]
if(length(data1!=0))
{
nj[j,]<-Find_Mode(data1)
}
}
Find_Mode<-function(Data)
{
row<-nrow(Data)
column<-ncol(Data)
CColumnValue<-vector()
New_Mode<-vector()
dataset1<-vector()
NNew_Mode<-vector()
for(i in 1:column)
{
CColumnValue<-matrix(c(unique(Data[,i])),ncol=1)
for(j in 1:length( CColumnValue))
{m<-length(which(Data[,i]==CColumnValue[j,]))
dataset1[j]<-m
}
q<-min(which((dataset1==max(dataset1)),arr.ind=T))
New_Mode[i]<-CColumnValue[q,]
}
NNew_Mode<-matrix(c(New_Mode),nrow=1)
}
for(i in 1:K)
{
data1<-data[(cid==i),]
if(length(data1!=0))
{
nj[j,]<-Find_Mode(data1)
}
}
nj<-ni
data1<-vector()
for(i in 1:K)
{
data1<-data[(cid==i),]
if(length(data1!=0))
{
nj[j,]<-Find_Mode(data1)
}
}
for(i in 1:K)
{
data1<-data[(cid==i),]
if(length(data1!=0))
{
nj[i,]<-Find_Mode(data1)
}
}
for(i in 1:K)
{
data1<-data[(cid==i),]
if(length(data1)!=0)
{
nj[i,]<-Find_Mode(data1)
}
}
nj
i<-1
data1<-data[(cid==i),]
if(length(data1)!=0)
{
nr[,i]<-dim(data1)[1]
nj[i,]<-Find_Mode(data1)
}
data1<-data[(cid==i),]
if(length(data1)!=0)
{
nj[i,]<-Find_Mode(data1)
}
nj
data1<-data[(cid==i),]
data1
Find_Mode<-function(Data)
Data<-data1
row<-nrow(Data)
Data<-data1
row<-nrow(Data)
row
column<-ncol(Data)
column
CColumnValue<-vector()
New_Mode<-vector()
dataset1<-vector()
NNew_Mode<-vector()
for(i in 1:column)
{
CColumnValue<-matrix(c(unique(Data[,i])),ncol=1)
for(j in 1:length( CColumnValue))
{m<-length(which(Data[,i]==CColumnValue[j,]))
dataset1[j]<-m
}
q<-min(which((dataset1==max(dataset1)),arr.ind=T))
New_Mode[i]<-CColumnValue[q,]
}
NNew_Mode<-matrix(c(New_Mode),nrow=1)
}
NNew_Mode
cid
data
n<-nrow(data)
d<-ncol(data)
cid<-vector(length=n)
oldcia<-matrix(1,nrow=n,ncol=K)
nr<-matrix(0,nrow=n,ncol=K)
if(is.null(InitialCenters)){
centers<-data[sample(n,K),]
}else{
centers<-data[InitialCenters,]
}
row.names(centers)<-c(1:K)
ni<-centers
ni
FW_dist<-vector()
Dist<-vector()
for(i in 1:n)
{
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
for(j in 1:K)
{
MM<-data[i,]
NN<-ni[j,]
WW<-Distance_of_Categorical(MM,NN)
if(WW==0){
cid[i]<-j
}else{
W<-matrix(c(WW),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
Fw_dist<-as.matrix(Dist)
ind<-which(Fw_dist==max(Fw_dist[,1]),arr.ind = T)[1]
cid[i]<-ind
}
}
}
cid
nr<-table(cid)
nr
i<-1
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
dist
N<-ncol(dist)
N
N<-nrow(dist)
N
for(i in 1:n)
{
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
ww<-dist[N,]
if(WW==0){
Dist[j]<-1
}else{
W<-matrix(c(WW),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Fw_dist<-as.matrix(Dist)
ind<-which(Fw_dist==max(Fw_dist[,1]),arr.ind = T)[1]
cid[i]<-ind
}
dist[N,]
cid
for(i in 1:n)
{
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
ww<-dist[N,]
if(WW==0){
Dist[j]<-1
}else{
W<-matrix(c(WW),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Fw_dist<-as.matrix(Dist)
ind<-which(Fw_dist==max(Fw_dist[,1]),arr.ind = T)[1]
cid[i]<-ind
}
cid
i<-1
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
dist
for(j in 1:N)
{
ww<-dist[N,]
if(WW==0){
Dist[j]<-1
}else{
W<-matrix(c(WW),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Dist
i<-1
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
dist
N<-nrow(dist)
N
j<-1
ww<-dist[N,]
WW
ww<-dist[j,]
WW
j<-1
ww<-dist[j,]
WW
j<-2
ww<-dist[j,]
WW
j<-1
Ds<-dist[j,]
Ds
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
Dist
for(i in 1:n)
{
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Fw_dist<-as.matrix(Dist)
ind<-which(Fw_dist==max(Fw_dist[,1]),arr.ind = T)[1]
cid[i]<-ind
}
cid
table(cid)
InitialCenters
View(data)
nj<-ni
data1<-vector()
for(i in 1:K)
{
data1<-data[(cid==i),]
if(length(data1)!=0)
{
nj[i,]<-Find_Mode(data1)
}
}
nj
i<-1
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Dist
i<-2
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Dist
i<-3
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Dist
i<-4
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Dist
i<-5
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Dist
i<-6
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Dist
i<-7
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Dist
i<-8
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Dist
Fw_dist<-as.matrix(Dist)
ind<-which(Fw_dist==max(Fw_dist[,1]),arr.ind = T)[1]
ind
Fuzzy_K_Mode<-function(data,K,iiter,InitialCenters)
{
{
n<-nrow(data)
d<-ncol(data)
}
cid<-vector(length=n)
oldcia<-matrix(1,nrow=n,ncol=K)
nr<-matrix(0,nrow=n,ncol=K)
if(is.null(InitialCenters)){
centers<-data[sample(n,K),]
}else{
centers<-data[InitialCenters,]
}
row.names(centers)<-c(1:K)
ni<-centers
nid<-nrow(ni)
if(nid!=K)
print(error)
iter<-1
while(iter<=iiter)
{
{
ptm<-proc.time()
FW_dist<-vector()
Dist<-vector()
for(i in 1:n)
{
q<-matrix(c(rep(data[i,],K)),nrow=K,ncol=d,byrow=T)
dist<-Distance_of_Categorical(q,ni)
N<-nrow(dist)
for(j in 1:N)
{
Ds<-dist[j,]
if(Ds==0){
Dist[j]<-1
}else{
W<-matrix(c(Ds),nrow=K,ncol=1)
Dist[j]<-1/(sum((W/dist)^10))
}
}
Fw_dist<-as.matrix(Dist)
ind<-which(Fw_dist==max(Fw_dist[,1]),arr.ind = T)[1]
cid[i]<-ind
}
}
}
}
cid
table(cid)
